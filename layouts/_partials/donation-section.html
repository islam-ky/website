{{/* Community Support/Donation Section Partial 
     Configurable via page params (supports both flat and nested structures):
     Flat: section_title, section_subtitle, etc. at root level
     Nested: donation_section.section_title, donation_section.section_subtitle, etc.
*/}}

{{/* Check for nested params first (Netlify CMS), then flat params (backward compatibility) */}}
{{- $section := .Params.donation_section | default dict -}}
{{- $title := $section.section_title | default .Params.section_title | default "Support Our Community" -}}
{{- $subtitle := $section.section_subtitle | default .Params.section_subtitle | default "Your generous contributions help maintain our mosque, support community programs, and serve those in need" -}}
{{- $ctaTitle := $section.cta_title | default .Params.cta_title | default "Make a Difference Today" -}}
{{- $ctaText := $section.cta_text | default .Params.cta_text | default "Your donation, no matter the size, helps strengthen our community and support our mission of building faith, knowledge, and service." -}}
{{- $quote := $section.quote | default .Params.quote | default "\"The example of those who spend their wealth in the way of Allah is like a seed of grain which grows seven spikes...\" - Quran 2:261" -}}
{{- $donateButtonText := $section.donate_button_text | default .Params.donate_button_text | default "Donate Now" -}}
{{- $learnMoreText := $section.learn_more_text | default .Params.learn_more_text | default "Learn More About Giving" -}}
{{- $donateUrl := $section.donate_url | default .Params.donate_url | default "/donate/" -}}
{{- $footerText := $section.footer_text | default .Params.footer_text | default "All donations are tax-deductible. Contact us for donation receipts or recurring giving options." -}}

{{- $defaultPurposes := slice
  (dict "icon" "mosque" "title" "Mosque Operations" "description" "Help maintain our prayer facilities, utilities, and daily operational needs")
  (dict "icon" "education" "title" "Educational Programs" "description" "Support Quran classes, Islamic education, and youth development programs")
  (dict "icon" "community" "title" "Community Support" "description" "Assist families in need, emergency support, and community welfare initiatives")
-}}
{{- $purposes := .Params.donation_purposes | default $defaultPurposes -}}

<div class="donation-section max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 rounded-lg">
  <div class="text-center mb-12">
    <h2 class="donation-title text-4xl font-bold mb-4">
      {{ $title }}
    </h2>
    <p class="donation-subtitle text-xl max-w-3xl mx-auto">
      {{ $subtitle }}
    </p>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-{{ len $purposes }} gap-8 mb-12">
    {{- range $purposes -}}
    <div class="text-center">
      <div class="w-16 h-16 bg-primary-100 dark:bg-primary-900/50 rounded-full flex items-center justify-center mx-auto mb-4">
        {{- if eq .icon "mosque" -}}
        <svg class="w-8 h-8 text-primary-600 dark:text-primary-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
        </svg>
        {{- else if eq .icon "education" -}}
        <svg class="w-8 h-8 text-primary-600 dark:text-primary-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
        </svg>
        {{- else if eq .icon "community" -}}
        <svg class="w-8 h-8 text-primary-600 dark:text-primary-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
        </svg>
        {{- else if eq .icon "dollar" -}}
        <svg class="w-8 h-8 text-primary-600 dark:text-primary-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        {{- else if eq .icon "hands" -}}
        <svg class="w-8 h-8 text-primary-600 dark:text-primary-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 11.5V14m0-2.5v-6a1.5 1.5 0 113 0m-3 6a1.5 1.5 0 00-3 0v2a7.5 7.5 0 0015 0v-5a1.5 1.5 0 00-3 0m-6-3V11m0-5.5v-1a1.5 1.5 0 013 0v1m0 0V11m0-5.5a1.5 1.5 0 013 0v3m0 0V11"></path>
        </svg>
        {{- else -}}
        {{/* Default heart icon */}}
        <svg class="w-8 h-8 text-primary-600 dark:text-primary-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
        </svg>
        {{- end -}}
      </div>
      <h3 class="donation-card-title text-xl font-semibold mb-2">{{ .title }}</h3>
      <p class="donation-card-text text-sm">
        {{ .description }}
      </p>
    </div>
    {{- end -}}
  </div>

  {{/* Donation Call-to-Action */}}
  <div class="text-center">
    <h3 class="donation-cta-title text-2xl font-semibold mb-4">
      {{ $ctaTitle }}
    </h3>
    <p class="donation-cta-text mb-6 max-w-2xl mx-auto">
      {{ $ctaText }}
    </p>
    
    {{- if $quote -}}
    <div class="mb-6">
      <p class="donation-quote text-sm italic">
        {{ $quote }}
      </p>
    </div>
    {{- end -}}

    <div class="flex flex-col sm:flex-row gap-4 justify-center">
      <a href="{{ $donateUrl }}" class="inline-flex items-center bg-primary-600 hover:bg-primary-700 text-white font-medium py-4 px-8 rounded-lg transition-all duration-300 hover:shadow-lg">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
        </svg>
        {{ $donateButtonText }}
      </a>
      <a href="{{ $donateUrl }}" class="donation-btn-secondary inline-flex items-center border-2 font-medium py-4 px-8 rounded-lg transition-all duration-300">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        {{ $learnMoreText }}
      </a>
    </div>

    {{- if $footerText -}}
    <div class="donation-footer mt-6 text-sm">
      <p>{{ $footerText }}</p>
    </div>
    {{- end -}}
  </div>
</div>
<style>
/* Text color variation for dark mode only */
.dark .donation-title,
.dark .donation-card-title,
.dark .donation-cta-title {
  color: #ffffff; /* bright white for titles */
}

.dark .donation-subtitle,
.dark .donation-card-text,
.dark .donation-cta-text {
  color: #9ca3af; /* muted gray for content */
}

.dark .donation-quote,
.dark .donation-footer {
  color: #6b7280; /* most muted gray for fine print */
}

.dark .donation-btn-secondary {
  border-color: #818cf8; /* lighter border in dark mode */
  color: #818cf8; /* lighter text in dark mode */
}

.dark .donation-btn-secondary:hover {
  background-color: #6366f1;
  color: #ffffff;
}
</style>

